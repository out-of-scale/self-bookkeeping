# iPhone 快捷指令配置 — 一键记账

> 截图 → 自动识别 → 记账完成，全程 3 秒

---

## 快捷指令配置（只需 5 步）

打开 iPhone「快捷指令」App → 点右上角 `+` 创建新指令

### ① 截取屏幕截图

搜索 **「截屏」** → 添加 **「截取屏幕截图」**

### ② 把图片转成 Base64

搜索 **「Base64」** → 添加 **「Base64 编码」**
- 输入会自动连接上一步的「屏幕截图」

### ③ 发送到服务器（重点！）

搜索 **「URL」** → 添加 **「获取URL内容」**

按以下设置：

```
URL:        http://192.168.1.109:8000/api/upload_receipt
方法:       POST
请求体:     JSON           ← 注意选 JSON，不要选「文件」
```

然后在请求体下方 **添加新字段**：
- 键：`image_base64`
- 文本：点击选择 **「Base64 编码」** 变量（上一步的结果）

> ⚠️ 不需要手动拼 JSON 文本！让系统自动处理

### ④ 提取结果

搜索 **「词典」** → 添加 **「获取词典值」**
- 类型：选择 **值**
- 键：输入 `message`

### ⑤ 弹出通知

搜索 **「通知」** → 添加 **「显示通知」**
- 正文：选择上一步的 **「词典值」**

---

## 命名并保存

点击顶部名称，改为 **「记账」** → 点 **完成**

---

## 完整操作链

```
截取屏幕截图
      ↓
Base64 编码（屏幕截图）
      ↓
获取URL内容
  URL: http://192.168.1.109:8000/api/upload_receipt
  方法: POST
  请求体: JSON → image_base64 = 「Base64 编码」
      ↓
获取词典值（键: message）
      ↓
显示通知（正文: 词典值）
```

---

## 怎么用

### 方法一：手动运行
1. 打开支付成功页面
2. 打开「快捷指令」App → 点「记账」
3. 等几秒 → 弹出通知 `✅ 记账成功：星巴克 - 💸38.0元`

### 方法二：双击背面触发（推荐 🔥）
1. 设置 → 辅助功能 → 触控 → 轻点背面
2. 轻点两下 → 选择「记账」
3. 以后支付完，双击手机背面即可

---

## 常见问题

**Q: 提示连接失败/超时？**
- 确认手机和电脑在同一 WiFi
- 手机浏览器打开 `http://192.168.1.109:8000/api/health` 测试

**Q: 部署到服务器后怎么改？**
- 修改第 ③ 步的 URL 即可
